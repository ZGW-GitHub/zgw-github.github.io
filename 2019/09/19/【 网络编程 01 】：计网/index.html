<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>【 网络编程 01 】：计网 | 愆凡の博客</title><meta name="description" content="【 网络编程 01 】：计网"><meta name="author" content="愆凡"><meta name="copyright" content="愆凡"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="【 网络编程 01 】：计网"><meta name="twitter:description" content="【 网络编程 01 】：计网"><meta name="twitter:image" content="http://yoursite.com/img/avatar.png"><meta property="og:type" content="article"><meta property="og:title" content="【 网络编程 01 】：计网"><meta property="og:url" content="http://yoursite.com/2019/09/19/%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/"><meta property="og:site_name" content="愆凡の博客"><meta property="og:description" content="【 网络编程 01 】：计网"><meta property="og:image" content="http://yoursite.com/img/avatar.png"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      now = new Date();
      hour = now.getHours();
      isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://yoursite.com/2019/09/19/%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/"><link rel="prev" title="【 Redis 系列 01 】：Redis" href="http://yoursite.com/2019/09/21/%E3%80%90%20Redis%20%E7%B3%BB%E5%88%97%2001%20%E3%80%91%EF%BC%9ARedis/"><link rel="next" title="【 Dubbo 系列 02 】：SpringBoot 整合 Dubbo" href="http://yoursite.com/2019/09/17/%E3%80%90%20Dubbo%20%E7%B3%BB%E5%88%97%2002%20%E3%80%91%EF%BC%9ASpringBoot%20%E6%95%B4%E5%90%88%20Dubbo/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://blog.notuptoyou.site","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: false,
  isFontAwesomeV5: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">50</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">14</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">12</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、计算机网络体系结构"><span class="toc-number">1.</span> <span class="toc-text">一、计算机网络体系结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、OSI-七层模型"><span class="toc-number">1.1.</span> <span class="toc-text">1、OSI 七层模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、TCP-IP-四层模型"><span class="toc-number">1.2.</span> <span class="toc-text">2、TCP &#x2F; IP 四层模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#TCP-IP协议数据流"><span class="toc-number">1.2.1.</span> <span class="toc-text">TCP IP协议数据流</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、UDP"><span class="toc-number">2.</span> <span class="toc-text">二、UDP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、UDP-报文段首部格式"><span class="toc-number">2.1.</span> <span class="toc-text">1、UDP 报文段首部格式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、TCP"><span class="toc-number">3.</span> <span class="toc-text">三、TCP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、TCP-报文段首部格式"><span class="toc-number">3.1.</span> <span class="toc-text">1、TCP 报文段首部格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、TCP-FLAG-标记"><span class="toc-number">3.2.</span> <span class="toc-text">2、TCP FLAG 标记</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、TCP-连接"><span class="toc-number">3.3.</span> <span class="toc-text">3、TCP 连接</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#a、TCP-三次握手"><span class="toc-number">3.3.1.</span> <span class="toc-text">a、TCP 三次握手</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#b、TCP-四次挥手"><span class="toc-number">3.3.2.</span> <span class="toc-text">b、TCP 四次挥手</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、连续-ARQ-协议-与-滑动窗口协议"><span class="toc-number">3.4.</span> <span class="toc-text">4、连续 ARQ 协议 与 滑动窗口协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ARQ-协议："><span class="toc-number">3.4.1.</span> <span class="toc-text">ARQ 协议：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#滑动窗口协议："><span class="toc-number">3.4.2.</span> <span class="toc-text">滑动窗口协议：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5、TCP-拆包-粘包"><span class="toc-number">3.5.</span> <span class="toc-text">5、TCP 拆包 &#x2F; 粘包</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#解决："><span class="toc-number">3.5.1.</span> <span class="toc-text">解决：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Netty-对解决方案的封装："><span class="toc-number">3.5.2.</span> <span class="toc-text">Netty 对解决方案的封装：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、TCP-与-UDP-区别"><span class="toc-number">4.</span> <span class="toc-text">四、TCP 与 UDP 区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、HTTP"><span class="toc-number">5.</span> <span class="toc-text">五、HTTP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、请求"><span class="toc-number">5.1.</span> <span class="toc-text">1、请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、响应"><span class="toc-number">5.2.</span> <span class="toc-text">2、响应</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、HTTP-与-HTTPS"><span class="toc-number">5.3.</span> <span class="toc-text">3、HTTP 与 HTTPS</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/post.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">愆凡の博客</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></span></div><div id="post-info"><div id="post-title"><div class="posttitle">【 网络编程 01 】：计网</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2019-09-19<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-03-21</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/">网络编程</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><p><img src="/" alt="网络协议全图" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E5%85%A8%E5%9B%BE.jpg"></p>
<h2 id="一、计算机网络体系结构"><a href="#一、计算机网络体系结构" class="headerlink" title="一、计算机网络体系结构"></a>一、计算机网络体系结构</h2><h3 id="1、OSI-七层模型"><a href="#1、OSI-七层模型" class="headerlink" title="1、OSI 七层模型"></a>1、OSI 七层模型</h3><blockquote>
<p><strong>开放系统互连基本参考模型 OSI/RM ( Open System Interconnection Reference Model )</strong></p>
</blockquote>
<p><img src="/" alt="OSI 七层模型" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/OSI%20%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B.png"></p>
<h3 id="2、TCP-IP-四层模型"><a href="#2、TCP-IP-四层模型" class="headerlink" title="2、TCP / IP 四层模型"></a>2、TCP / IP 四层模型</h3><p><img src="/" alt="对比图" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/%E5%AF%B9%E6%AF%94%E5%9B%BE.jpg"></p>
<h4 id="TCP-IP协议数据流"><a href="#TCP-IP协议数据流" class="headerlink" title="TCP IP协议数据流"></a>TCP IP协议数据流</h4><p><img src="/" alt="TCP IP协议数据流" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/TCP%20IP%E5%8D%8F%E8%AE%AE%E6%95%B0%E6%8D%AE%E6%B5%81.png"></p>
<h2 id="二、UDP"><a href="#二、UDP" class="headerlink" title="二、UDP"></a>二、UDP</h2><blockquote>
<p><strong>UDP 是无连接的</strong></p>
<ul>
<li>即发送数据之前不需要建立连接（当然，发送数据结束时也没有连接可释放），因此减少了开销和发送数据之前的时延。</li>
</ul>
<p><strong>UDP 使用尽最大努力交付</strong></p>
<ul>
<li>即不保证可靠交付，因此主机不需要维持复杂的连接状态表（这里面有许多参数）。</li>
</ul>
<p><strong>UDP 是面向报文的</strong></p>
<ul>
<li>发送方的 UDP 对应用程序交下来的报文，在添加首部后就向下交付 IP 层。UDP 对应用层交下来的报文，既不合并，也不拆分，而是保留这些报文的边界。这就是说，应用层交给 UDP 多长的报文，UDP 就照样发送，即：一次发送一个报文。</li>
<li>在接收方的 UDP，对 IP 层交上来的 UDP 用户数据报，在去除首部后就原封不动地交付上层的应用进程。也就是说，UDP 一次交付一个完整的报文。</li>
<li>因此，应用程序必须选择合适大小的报文。若报文太长，UDP 把它交给 IP 层后，IP 层在传送时可能要进行分片，这会降低 IP 层的效率。反之，若报文太短，UDP 把它交给 IP 层后，会使 IP 数据报的首部的相对长度太大，这也降低了 IP 层的效率。</li>
</ul>
<p><strong>UDP 没有拥塞控制</strong></p>
<ul>
<li>因此网络出现的拥塞不会使源主机的发送速率降低。这对某些实时应用是很重要的。很多的实时应用（如IP电话、实时视频会议等）要求源主机以恒定的速率发送数据，并且允许在网络发生拥塞时丢失一些数据，但却不允许数据有太大的时延。UDP 正好适合这种要求。</li>
</ul>
<p><strong>UDP 支持一对一、一对多、多对一和多对多的交互通信</strong>。</p>
<p><strong>UDP 的首部开销小</strong>，只有8个字节，比 TCP 的 20 个字节的首部要短。</p>
</blockquote>
<h3 id="1、UDP-报文段首部格式"><a href="#1、UDP-报文段首部格式" class="headerlink" title="1、UDP 报文段首部格式"></a>1、UDP 报文段首部格式</h3><p><img src="/" alt="UDP 报文段首部格式" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/UDP%20%E6%8A%A5%E6%96%87%E6%AE%B5%E9%A6%96%E9%83%A8%E6%A0%BC%E5%BC%8F.png"></p>
<h2 id="三、TCP"><a href="#三、TCP" class="headerlink" title="三、TCP"></a>三、TCP</h2><blockquote>
<p><strong>TCP 是面向连接的运输层协议</strong></p>
<ul>
<li>这就是说，应用程序在使用 TCP 协议之前，必须先建立 TCP 连接。在传送数据完毕后，必须释放已经建立的 TCP 连接。</li>
</ul>
<p>每一条 TCP 连接只能有两个端点（endpoint），<strong>每一条 TCP 连接只能是点对点的（一对一）</strong>。</p>
<p><strong>TCP 提供可靠交付的服务</strong></p>
<ul>
<li>通过TCP连接传送的数据，无差错、不丢失、不重复，并且按序到达。</li>
</ul>
<p><strong>TCP 提供全双工通信</strong></p>
<ul>
<li>TCP 允许通信双方的应用进程在任何时候都能发送数据。TCP 连接的两端都设有发送缓存和接收缓存，用来临时存放双向通信的数据。在发送时，应用程序在把数据传送给 TCP 的缓存后，就可以做自己的事，而 TCP 在合适的时候把数据发送出去。在接收时，TCP 把收到的数据放入缓存，上层的应用进程在合适的时候读取缓存中的数据。</li>
</ul>
<p><strong>面向字节流</strong></p>
<ul>
<li>TCP 中的<strong>”流”（stream）指的是流入到进程或从进程流出的字节序列</strong>。</li>
<li>“面向字节流”的含义是：虽然应用程序和 TCP 的交互是一次一个数据块（大小不等），但 TCP 把应用程序交下来的数据仅仅看成是一连串的无结构的字节流。TCP 并不知道所传送的字节流的含义。TCP 不保证接收方应用程序所收到的数据块和发送方应用程序所发出的数据块具有对应大小的关系（例如，发送方应用程序交给发送方的 TCP 共 10 个数据块，但接收方的 TCP 可能只用了 4 个数据块就把收到的字节流交付上层的应用程序）。但接收方应用程序收到的字节流必须和发送方应用程序发出的字节流完全一样。当然，接收方的应用程序必须有能力识别收到的字节流，把它还原成有意义的应用层数据。下图是上述概念的示意图。</li>
<li><img src="/" alt="面向字节流" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/%E9%9D%A2%E5%90%91%E5%AD%97%E8%8A%82%E6%B5%81.png"></li>
<li>为了突出示意图的要点，图中只画出了一个方向的数据流。但要注意，在实际的网络中，一个 TCP 报文段包含上千个字节是很常见的，而图中的各部分都只画出了几个字节，这仅仅是为了更方便地说明“面向字节流”的概念。</li>
<li>另一点很重要的是：图中的 TCP 连接是一条虚连接（也就是逻辑连接），而不是一条真正的物理连接。TCP 报文段先要传送到 IP 层，加上 IP 首部后，再传送到数据链路层。再加上数据链路层的首部和尾部后，才离开主机发送到物理链路。</li>
<li>图中指出，TCP 和 UDP 在发送报文时所采用的方式完全不同。TCP 并不关心应用进程一次把多长的报文发送到 TCP 的缓存中，而是根据对方给出的窗口值和当前网络拥塞的程度来决定一个报文段应包含多少个字节（UDP 发送的报文长度是应用进程给出的）。如果应用进程传送到 TCP 缓存的数据块太长，TCP 就可以把它划分短一些再传送。如果应用进程一次只发来一个字节，TCP 也可以等待积累有足够多的字节后再构成报文段发送出去。</li>
</ul>
</blockquote>
<h3 id="1、TCP-报文段首部格式"><a href="#1、TCP-报文段首部格式" class="headerlink" title="1、TCP 报文段首部格式"></a>1、TCP 报文段首部格式</h3><p><img src="/" alt="TCP 报文段首部格式" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/TCP%20%E6%8A%A5%E6%96%87%E6%AE%B5%E9%A6%96%E9%83%A8%E6%A0%BC%E5%BC%8F.png"></p>
<h3 id="2、TCP-FLAG-标记"><a href="#2、TCP-FLAG-标记" class="headerlink" title="2、TCP FLAG 标记"></a>2、TCP FLAG 标记</h3><p>基于标记的 TCP 包匹配经常被用于过滤试图打开新连接的 TCP 数据包 。</p>
<p>TCP 标记和它们的意义如下所列 ：</p>
<ul>
<li>F : FIN           -     结束 ; 结束会话</li>
<li>S : SYN          -     同步 ; 表示开始会话请求</li>
<li>R : RST          -     复位 ; 中断一个连接</li>
<li>P : PUSH       -     推送 ; 数据包立即发送</li>
<li>A : ACK          -     应答</li>
<li>U : URG         -     紧急</li>
<li>E : ECE           -     显式拥塞提醒回应</li>
<li>W : CWR        -     拥塞窗口减少</li>
</ul>
<h3 id="3、TCP-连接"><a href="#3、TCP-连接" class="headerlink" title="3、TCP 连接"></a>3、TCP 连接</h3><p><img src="/" alt="TCP 三次握手 四次挥手" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/TCP%20%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%20%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.png"></p>
<h4 id="a、TCP-三次握手"><a href="#a、TCP-三次握手" class="headerlink" title="a、TCP 三次握手"></a>a、TCP 三次握手</h4><p><img src="/" alt="TCP 三次握手" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/TCP%20%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B.jpg"></p>
<h4 id="b、TCP-四次挥手"><a href="#b、TCP-四次挥手" class="headerlink" title="b、TCP 四次挥手"></a>b、TCP 四次挥手</h4><p><img src="/" alt="TCP 四次挥手" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/TCP%20%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.jpg"></p>
<p><img src="/" alt="四次挥手" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.png"></p>
<h3 id="4、连续-ARQ-协议-与-滑动窗口协议"><a href="#4、连续-ARQ-协议-与-滑动窗口协议" class="headerlink" title="4、连续 ARQ 协议 与 滑动窗口协议"></a>4、连续 ARQ 协议 与 滑动窗口协议</h3><h4 id="ARQ-协议："><a href="#ARQ-协议：" class="headerlink" title="ARQ 协议："></a>ARQ 协议：</h4><blockquote>
<p>ARQ 协议，即自动重传请求（Automatic Repeat-reQuest），是 OSI 模型中数据链路层和传输层的错误纠正协议之一。</p>
<p>它通过使用确认和超时这两个机制，在不可靠服务的基础上实现可靠的信息传输。如果发送方在发送后一段时间之内没有收到确认帧，它通常会重新发送。</p>
</blockquote>
<p>ARQ 分为：</p>
<ul>
<li><p>停止等待 ARQ 协议</p>
<p>每发送一个数据包就等待 ACK 确认。</p>
</li>
<li><p><strong>连续 ARQ 协议</strong></p>
<p>会连续发送一组数据包，然后再等待这些数据包的 ACK 确认。</p>
<p>连续 ARQ 协议通常是结合滑动窗口协议来使用的，发送方需要维持一个发送窗口。</p>
</li>
</ul>
<p>ARQ 协议拥有错误检测（Error Detection）、正面确认（Positive Acknowledgment）、超时重传（Retransmission after Timeout）和 负面确认及重传（Negative Acknowledgment and Retransmission）等机制。</p>
<h4 id="滑动窗口协议："><a href="#滑动窗口协议：" class="headerlink" title="滑动窗口协议："></a>滑动窗口协议：</h4><blockquote>
<p>连续 ARQ 协议通常是结合滑动窗口协议来使用的，发送方需要维持一个发送窗口。</p>
<p>滑动窗口协议，是 TCP 协议的精髓所在。</p>
<p>下图表示发送方维持的发送窗口，它的意义是：位于发送窗口内的 5 个分组都可连续发送出去，而不需要等待对方的确认。这样，信道利用率就提高了。</p>
</blockquote>
<p><img src="/" alt="滑动窗口" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3.png"></p>
<h3 id="5、TCP-拆包-粘包"><a href="#5、TCP-拆包-粘包" class="headerlink" title="5、TCP 拆包 / 粘包"></a>5、TCP 拆包 / 粘包</h3><p><img src="/" alt="TCP 粘包/拆包" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/TCP%20%E7%B2%98%E5%8C%85_%E6%8B%86%E5%8C%85.png"></p>
<h4 id="解决："><a href="#解决：" class="headerlink" title="解决："></a>解决：</h4><p>对于这样的问题只能通过上层的应用来解决，常见的方式有：</p>
<ul>
<li>在报文末尾增加换行符表明一条完整的消息，这样在接收端可以根据这个换行符来判断消息是否完整。</li>
<li>将消息分为消息头、消息体。可以在消息头中声明消息的长度，根据这个长度来获取报文（ 比如 808 协议 ）。</li>
<li>规定好报文长度，不足的空位补齐，取的时候按照长度截取即可。</li>
</ul>
<h4 id="Netty-对解决方案的封装："><a href="#Netty-对解决方案的封装：" class="headerlink" title="Netty 对解决方案的封装："></a>Netty 对解决方案的封装：</h4><p>针对 TCP 粘包 / 拆包 的解决 Netty 已经帮我们做好了，完全可以开箱即用。</p>
<p>比如：</p>
<ul>
<li><code>LineBasedFrameDecoder</code> 可以基于换行符解决。</li>
<li><code>DelimiterBasedFrameDecoder</code> 可基于分隔符解决。</li>
<li><code>FixedLengthFrameDecoder</code> 可指定长度解决。</li>
</ul>
<h2 id="四、TCP-与-UDP-区别"><a href="#四、TCP-与-UDP-区别" class="headerlink" title="四、TCP 与 UDP 区别"></a>四、TCP 与 UDP 区别</h2><ul>
<li>面向连接 VS 无连接</li>
<li>可靠性</li>
<li>有序性</li>
<li>速度</li>
<li>量级</li>
</ul>
<h2 id="五、HTTP"><a href="#五、HTTP" class="headerlink" title="五、HTTP"></a>五、HTTP</h2><h3 id="1、请求"><a href="#1、请求" class="headerlink" title="1、请求"></a>1、请求</h3><p><img src="/" alt="HTTP 请求结构" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/HTTP%20%E8%AF%B7%E6%B1%82%E7%BB%93%E6%9E%84.png"></p>
<h3 id="2、响应"><a href="#2、响应" class="headerlink" title="2、响应"></a>2、响应</h3><p><img src="/" alt="HTTP 响应结构" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/HTTP%20%E5%93%8D%E5%BA%94%E7%BB%93%E6%9E%84.png"></p>
<blockquote>
<p>响应码</p>
<ul>
<li>1xx：指示信息               –        请求已接收，继续处理</li>
<li>2xx：成功                       –        请求已被成功接收、理解、接受</li>
<li>3xx：重定向                   –        要完成请求必须进行更进一步的操作</li>
<li>4xx：客户端错误           –        请求有语法错误或请求无法实现</li>
<li>5xx：服务器端错误       –        服务器未能实现合法的请求</li>
</ul>
<p>常见响应码</p>
<ul>
<li>400 Bad Request                   客户端请求有语法错误，不能被服务器所理解</li>
<li>401 Unauthorized                 请求未经授权，这个状态代码必须和 <code>WWW-Authenticate</code> 报头域一起使用</li>
<li>403 Forbidden                       服务器收到请求，但是拒绝提供服务</li>
<li>404 Not Found                       请求资源不存在，eg：输入了错误的URL</li>
<li>500 Internal Server Error     服务器发生不可预期的错误</li>
<li>503 Server Unavailable        服务器当前不能处理客户端的请求，一段时间后可能恢复正常</li>
</ul>
</blockquote>
<h3 id="3、HTTP-与-HTTPS"><a href="#3、HTTP-与-HTTPS" class="headerlink" title="3、HTTP 与 HTTPS"></a>3、HTTP 与 HTTPS</h3><p><img src="/" alt="HTTP 与 HTTPS" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/HTTP%20%E4%B8%8E%20HTTPS.jpg"></p>
<p><img src="/" alt="HTTP 与 HTTPS" class="lazyload" data-src="%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/HTTP%20%E4%B8%8E%20HTTPS.png"></p>
<blockquote>
<p>SSL ( Security Sockets Layer )  安全套接层</p>
<ul>
<li>是采用身份验证和数据加密为网络通信提供安全及数据完整性的一种安全协议</li>
<li>是操作系统对外的 API</li>
<li><strong>SSL 3.0 后更名为 TLS</strong></li>
</ul>
<p>加密的方式</p>
<ul>
<li>对称加密：加密和解密都使用同一个密钥</li>
<li>非对称加密：加密使用的密钥和解密使用的密钥是不相同的</li>
<li>哈希算法：将任意长度的信息转换为固定长度的值，算法不可逆</li>
<li>数字签名：证明某个消息或者文件是某人发出/认同的</li>
</ul>
</blockquote>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">愆凡</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2019/09/19/%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/">http://yoursite.com/2019/09/19/%E3%80%90%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%2001%20%E3%80%91%EF%BC%9A%E8%AE%A1%E7%BD%91/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com" target="_blank">愆凡の博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2019/09/21/%E3%80%90%20Redis%20%E7%B3%BB%E5%88%97%2001%20%E3%80%91%EF%BC%9ARedis/"><img class="prev_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">【 Redis 系列 01 】：Redis</div></div></a></div><div class="next-post pull_right"><a href="/2019/09/17/%E3%80%90%20Dubbo%20%E7%B3%BB%E5%88%97%2002%20%E3%80%91%EF%BC%9ASpringBoot%20%E6%95%B4%E5%90%88%20Dubbo/"><img class="next_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">【 Dubbo 系列 02 】：SpringBoot 整合 Dubbo</div></div></a></div></nav></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By 愆凡</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">簡</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>